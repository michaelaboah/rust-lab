// use reqwest::blocking;
// use serde_json::Value;

// fn get_binance_symbols(api_url: &'_ str) -> Result<Vec<String>, Box<dyn std::error::Error>> {
//     let response = blocking::get(api_url)?.json::<Value>()?;
//     let symbols_objects = response.get("symbols").unwrap().as_array().unwrap();

//     let symbols: Vec<String> = symbols_objects
//         .iter()
//         .filter_map(|f| f.get("symbol").map(|js| js.as_str().unwrap().to_owned()))
//         .collect();
//     Ok(symbols)
// }

pub fn get_exchange_symbols(
    api_url: &'_ str,
    exchange: &'_ str,
) -> Result<Vec<String>, Box<dyn std::error::Error>> {
    let appended = format!("{}{}", api_url, exchange);
    println!("{}", appended);

    let symbols_objects = reqwest::blocking::get(appended)
        .unwrap()
        .json::<serde_json::Value>()
        .unwrap();
    let symbols: Vec<String> = symbols_objects
        .as_array()
        .unwrap()
        .iter()
        .map(|g| g.as_str().unwrap().to_owned())
        .collect();

    Ok(symbols)
}

#[cfg(test)]
mod tests {
    use super::*;
    const symbols: [&str; 505] = [
        "BTCUSD4",
        "ETHUSD4",
        "XRPUSD",
        "BCHUSD4",
        "LTCUSD4",
        "USDTUSD4",
        "BTCUSDT",
        "ETHUSDT",
        "XRPUSDT",
        "BCHUSDT",
        "LTCUSDT",
        "BNBUSD4",
        "BNBUSDT",
        "ETHBTC",
        "XRPBTC",
        "BNBBTC",
        "LTCBTC",
        "BCHBTC",
        "ADAUSD4",
        "BATUSD4",
        "ETCUSD4",
        "XLMUSD4",
        "ZRXUSD4",
        "ADAUSDT",
        "BATUSDT",
        "ETCUSDT",
        "XLMUSDT",
        "ZRXUSDT",
        "LINKUSD4",
        "RVNUSD4",
        "DASHUSD4",
        "ZECUSD4",
        "ALGOUSD4",
        "IOTAUSD4",
        "BUSDUSD4",
        "BTCBUSD",
        "DOGEUSDT",
        "WAVESUSD4",
        "ATOMUSDT",
        "ATOMUSD4",
        "NEOUSDT",
        "NEOUSD4",
        "VETUSDT",
        "QTUMUSDT",
        "QTUMUSD4",
        "NANOUSD",
        "ICXUSD4",
        "ENJUSD4",
        "ONTUSD4",
        "ONTUSDT",
        "ZILUSD4",
        "ZILBUSD",
        "VETUSD4",
        "BNBBUSD",
        "XRPBUSD",
        "ETHBUSD",
        "ALGOBUSD",
        "XTZUSD4",
        "XTZBUSD",
        "HBARUSD4",
        "HBARBUSD",
        "OMGUSD4",
        "OMGBUSD",
        "MATICUSD4",
        "MATICBUSD",
        "XTZBTC",
        "ADABTC",
        "REPBUSD",
        "REPUSD",
        "EOSBUSD",
        "EOSUSD4",
        "DOGEUSD4",
        "KNCUSD4",
        "KNCUSDT",
        "VTHOUSDT",
        "VTHOUSD4",
        "USDCUSD4",
        "COMPUSDT",
        "COMPUSD4",
        "MANAUSD4",
        "HNTUSD4",
        "HNTUSDT",
        "MKRUSD4",
        "MKRUSDT",
        "DAIUSD4",
        "ONEUSDT",
        "ONEUSD4",
        "BANDUSDT",
        "BANDUSD4",
        "STORJUSDT",
        "STORJUSD4",
        "BUSDUSDT",
        "UNIUSD4",
        "UNIUSDT",
        "SOLUSD4",
        "SOLUSDT",
        "LINKBTC",
        "VETBTC",
        "UNIBTC",
        "EGLDUSDT",
        "EGLDUSD4",
        "PAXGUSDT",
        "PAXGUSD4",
        "OXTUSDT",
        "OXTUSD4",
        "ZENUSDT",
        "ZENUSD4",
        "BTCUSDC",
        "ONEBUSD",
        "FILUSDT",
        "FILUSD4",
        "AAVEUSDT",
        "AAVEUSD4",
        "GRTUSDT",
        "GRTUSD4",
        "SUSHIUSD4",
        "ANKRUSD4",
        "AMPUSD",
        "SHIBUSDT",
        "SHIBBUSD",
        "CRVUSDT",
        "CRVUSD4",
        "AXSUSDT",
        "AXSUSD4",
        "SOLBTC",
        "AVAXUSDT",
        "AVAXUSD4",
        "CTSIUSDT",
        "CTSIUSD4",
        "DOTUSDT",
        "DOTUSD4",
        "YFIUSDT",
        "YFIUSD4",
        "1INCHUSDT",
        "1INCHUSD4",
        "FTMUSDT",
        "FTMUSD4",
        "USDCUSDT",
        "ETHUSDC",
        "USDCBUSD",
        "MATICUSDT",
        "MANAUSDT",
        "MANABUSD",
        "ALGOUSDT",
        "ADABUSD",
        "SOLBUSD",
        "LINKUSDT",
        "EOSUSDT",
        "ZECUSDT",
        "ENJUSDT",
        "NEARUSDT",
        "NEARBUSD",
        "NEARUSD4",
        "OMGUSDT",
        "SUSHIUSDT",
        "LRCUSDT",
        "LRCUSD4",
        "LRCBTC",
        "KSHIBUSD4",
        "LPTUSDT",
        "LPTBUSD",
        "LPTUSD4",
        "POLYUSDT",
        "POLYBUSD",
        "POLYUSD",
        "POLYBTC",
        "MATICBTC",
        "DOTBTC",
        "NMRUSDT",
        "NMRUSD4",
        "SLPUSDT",
        "SLPUSD4",
        "ANTUSDT",
        "ANTUSD4",
        "XNOUSD4",
        "CHZUSDT",
        "CHZUSD4",
        "OGNUSDT",
        "OGNUSD4",
        "GALAUSDT",
        "GALAUSD4",
        "TLMUSDT",
        "TLMUSD4",
        "SNXUSDT",
        "SNXUSD4",
        "AUDIOUSDT",
        "AUDIOUSD4",
        "ENSUSDT",
        "MANABTC",
        "ATOMBTC",
        "AVAXBTC",
        "WBTCBTC",
        "REQUSDT",
        "REQUSD4",
        "APEUSDT",
        "APEUSD4",
        "FLUXUSDT",
        "FLUXUSD4",
        "TRXBTC",
        "TRXBUSD",
        "TRXUSDT",
        "TRXUSD4",
        "COTIUSDT",
        "COTIUSD4",
        "VOXELUSDT",
        "VOXELUSD4",
        "RLCUSDT",
        "RLCUSD4",
        "USTUSDT",
        "USTUSD",
        "BICOUSDT",
        "BICOUSD4",
        "API3USDT",
        "API3USD4",
        "ENSUSD4",
        "BTCUST",
        "BNTUSDT",
        "BNTUSD4",
        "IMXUSDT",
        "IMXUSD4",
        "SPELLUSDT",
        "SPELLUSD4",
        "JASMYUSDT",
        "JASMYUSD4",
        "FLOWUSDT",
        "FLOWUSD4",
        "GTCUSDT",
        "GTCUSD4",
        "THETAUSDT",
        "THETAUSD4",
        "TFUELUSDT",
        "TFUELUSD4",
        "OCEANUSDT",
        "OCEANUSD4",
        "LAZIOUSDT",
        "LAZIOUSD4",
        "SANTOSUSDT",
        "SANTOSUSD4",
        "ALPINEUSDT",
        "ALPINEUSD4",
        "PORTOUSDT",
        "PORTOUSD4",
        "RENUSDT",
        "RENUSD4",
        "CELRUSDT",
        "CELRUSD4",
        "SKLUSDT",
        "SKLUSD4",
        "VITEUSDT",
        "VITEUSD4",
        "WAXPUSDT",
        "WAXPUSD4",
        "LTOUSDT",
        "LTOUSD4",
        "FETUSDT",
        "FETUSD4",
        "BONDUSDT",
        "BONDUSD4",
        "LOKAUSDT",
        "LOKAUSD4",
        "ICPUSDT",
        "ICPUSD4",
        "TUSDT",
        "TUSD4",
        "OPUSDT",
        "OPUSD4",
        "ROSEUSDT",
        "ROSEUSD4",
        "CELOUSDT",
        "CELOUSD4",
        "KDAUSDT",
        "KDAUSD4",
        "KSMUSDT",
        "KSMUSD4",
        "ACHUSDT",
        "ACHUSD4",
        "DARUSDT",
        "DARUSD4",
        "RNDRUSDT",
        "RNDRUSD4",
        "SYSUSDT",
        "SYSUSD4",
        "RADUSDT",
        "RADUSD4",
        "ILVUSDT",
        "ILVUSD4",
        "LDOUSDT",
        "LDOUSD4",
        "RAREUSDT",
        "RAREUSD4",
        "LSKUSDT",
        "LSKUSD4",
        "DGBUSDT",
        "DGBUSD4",
        "REEFUSDT",
        "REEFUSD4",
        "SRMUSDT",
        "SRMUSD",
        "ALICEUSDT",
        "ALICEUSD4",
        "FORTHUSDT",
        "FORTHUSD4",
        "ASTRUSDT",
        "ASTRUSD4",
        "BTRSTUSDT",
        "BTRSTUSD4",
        "GALUSDT",
        "GALUSD4",
        "SANDUSDT",
        "SANDUSD4",
        "BALUSDT",
        "BALUSD4",
        "POLYXUSD4",
        "GLMUSDT",
        "GLMUSD4",
        "CLVUSDT",
        "CLVUSD4",
        "TUSDUSDT",
        "TUSDUSD4",
        "QNTUSDT",
        "QNTUSD4",
        "STGUSDT",
        "STGUSD4",
        "AXLUSDT",
        "AXLUSD4",
        "KAVAUSDT",
        "KAVAUSD4",
        "APTUSDT",
        "APTUSD4",
        "MASKUSDT",
        "MASKUSD4",
        "BOSONUSDT",
        "BOSONUSD4",
        "PONDUSDT",
        "PONDUSD4",
        "SOLUSDC",
        "ADAUSDC",
        "MXCUSDT",
        "MXCUSD4",
        "JAMUSDT",
        "JAMUSD4",
        "PROMUSDT",
        "PROMUSD4",
        "DIAUSDT",
        "DIAUSD4",
        "BTCDAI",
        "ETHDAI",
        "ADAETH",
        "DOGEBTC",
        "LOOMUSDT",
        "LOOMUSD4",
        "STMXUSDT",
        "BTCUSD",
        "ETHUSD",
        "BCHUSD",
        "LTCUSD",
        "USDTUSD",
        "BNBUSD",
        "ADAUSD",
        "BATUSD",
        "ETCUSD",
        "XLMUSD",
        "ZRXUSD",
        "LINKUSD",
        "RVNUSD",
        "DASHUSD",
        "ZECUSD",
        "ALGOUSD",
        "IOTAUSD",
        "BUSDUSD",
        "WAVESUSD",
        "ATOMUSD",
        "NEOUSD",
        "QTUMUSD",
        "ICXUSD",
        "ENJUSD",
        "ONTUSD",
        "ZILUSD",
        "VETUSD",
        "XTZUSD",
        "HBARUSD",
        "OMGUSD",
        "MATICUSD",
        "EOSUSD",
        "DOGEUSD",
        "KNCUSD",
        "VTHOUSD",
        "USDCUSD",
        "COMPUSD",
        "MANAUSD",
        "HNTUSD",
        "MKRUSD",
        "DAIUSD",
        "ONEUSD",
        "BANDUSD",
        "STORJUSD",
        "UNIUSD",
        "SOLUSD",
        "EGLDUSD",
        "PAXGUSD",
        "OXTUSD",
        "ZENUSD",
        "FILUSD",
        "AAVEUSD",
        "GRTUSD",
        "SUSHIUSD",
        "ANKRUSD",
        "CRVUSD",
        "AXSUSD",
        "AVAXUSD",
        "CTSIUSD",
        "DOTUSD",
        "YFIUSD",
        "1INCHUSD",
        "FTMUSD",
        "NEARUSD",
        "LRCUSD",
        "KSHIBUSD",
        "LPTUSD",
        "NMRUSD",
        "SLPUSD",
        "ANTUSD",
        "XNOUSD",
        "CHZUSD",
        "OGNUSD",
        "GALAUSD",
        "TLMUSD",
        "SNXUSD",
        "AUDIOUSD",
        "REQUSD",
        "APEUSD",
        "FLUXUSD",
        "TRXUSD",
        "COTIUSD",
        "VOXELUSD",
        "RLCUSD",
        "BICOUSD",
        "API3USD",
        "ENSUSD",
        "BNTUSD",
        "IMXUSD",
        "SPELLUSD",
        "JASMYUSD",
        "FLOWUSD",
        "GTCUSD",
        "THETAUSD",
        "TFUELUSD",
        "OCEANUSD",
        "LAZIOUSD",
        "SANTOSUSD",
        "ALPINEUSD",
        "PORTOUSD",
        "RENUSD",
        "CELRUSD",
        "SKLUSD",
        "VITEUSD",
        "WAXPUSD",
        "LTOUSD",
        "FETUSD",
        "BONDUSD",
        "LOKAUSD",
        "ICPUSD",
        "TUSD",
        "OPUSD",
        "ROSEUSD",
        "CELOUSD",
        "KDAUSD",
        "KSMUSD",
        "ACHUSD",
        "DARUSD",
        "RNDRUSD",
        "SYSUSD",
        "RADUSD",
        "ILVUSD",
        "LDOUSD",
        "RAREUSD",
        "LSKUSD",
        "DGBUSD",
        "REEFUSD",
        "ALICEUSD",
        "FORTHUSD",
        "ASTRUSD",
        "BTRSTUSD",
        "GALUSD",
        "SANDUSD",
        "BALUSD",
        "POLYXUSD",
        "GLMUSD",
        "CLVUSD",
        "TUSDUSD",
        "QNTUSD",
        "STGUSD",
        "AXLUSD",
        "KAVAUSD",
        "APTUSD",
        "MASKUSD",
        "BOSONUSD",
        "PONDUSD",
        "MXCUSD",
        "JAMUSD",
        "PROMUSD",
        "DIAUSD",
        "LOOMUSD",
        "STMXUSD",
        "SHIBUSD",
    ];

    #[test]
    fn test_exchange_symbols() {
        let ref from_gq =
            get_exchange_symbols("https://api.goquant.io/symbols?exchange=", "binance").unwrap();
        assert!(from_gq.len() > 100)
    }
}
